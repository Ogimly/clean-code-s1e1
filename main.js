(()=>{"use strict";(()=>{const t=class{constructor(t=null,s="div",e="",i=""){const n=document.createElement(s);n.className=e,n.innerHTML=i,t&&t.append(n),this.node=n}destroy=()=>{this.node.remove()}};class s extends t{constructor(e,i,n){super(e,"li","task task-list__task");const a=n[0],d=n[1],{isCompleted:o,isEdit:h,task:c}=d;h&&this.node.classList.add("task-list__task_edit"),this.state=i,this.id=a,this.cbCompleted=s.addCheckBox(this.node,o),this.cbCompleted.node.onchange=()=>{this.moveTask()},this.lblTask=new t(this.node,"label","label task__label",c),this.lblTask.node.onclick=()=>{this.editTask()},this.inputTask=new t(this.node,"input","input-text task__input-text"),this.inputTask.node.value=c,this.inputTask.node.onchange=()=>{this.editTask()},this.btnEdit=s.addBtnEdit(this.node,h),this.btnEdit.node.onclick=()=>{this.editTask()},this.btnRemove=s.addBtnRemove(this.node),this.btnRemove.node.onclick=()=>{this.deleteTask()}}static addCheckBox(s,e){const i=new t(s,"input","input-checkbox task__input-checkbox");return i.node.type="checkbox",i.node.checked=e,i}static addBtnEdit(s,e){const i=new t(s,"button");return i.node.innerHTML=e?"Save":"Edit",i.node.className="button task__button task__button_edit",i}static addBtnRemove(s){const e=new t(s,"button","button task__button task__button_delete"),i=document.createElement("img");return i.className="button__img",i.alt="remove task",i.src="./remove.svg",e.node.append(i),e}getId(){return this.id}moveTask(){const{state:t}=this;t.data[this.id].isCompleted=!t.data[this.id].isCompleted,t.setData(t.data)}editTask(){const{state:t}=this,s=!t.data[this.id].isEdit;t.data[this.id].isEdit=s;let e="";e=s?this.lblTask.node.innerHTML:this.inputTask.node.value,t.data[this.id].task=e,t.setData(t.data)}deleteTask(){const{state:t}=this;delete t.data[this.id],t.setData(t.data)}}const e=s;class i extends t{constructor(s,e,n,a){super(s,"section"),this.h3=new t(this.node,"h3","title",a),this.ul=new t(this.node,"ul","task-list"),n&&this.node.classList.add("task-list_completed"),this.ul.node.id=n?"completed-tasks":"incomplete-tasks",i.LoadList(this.ul.node,e,n)}static LoadList(t,s,i){Object.entries(s.data).filter((t=>t[1].isCompleted===i)).forEach((i=>{new e(t,s,i).aaa=""}))}}const n=i,a=class extends t{constructor(s,e,i){super(s,"section"),this.state=e,this.h3=new t(this.node,"h3","title",i),this.div=new t(this.node,"div","task task-new"),this.inputTask=new t(this.div.node,"input","input-text task__input-text"),this.inputTask.node.onchange=()=>{this.addTask()},this.btnAdd=new t(this.div.node,"button","button task__button task__button_add","Add"),this.btnAdd.node.onclick=()=>{}}addTask(){const t=this.inputTask.node.value,{state:s}=this;s.data[s.currentId]={isCompleted:!1,isEdit:!1,task:t},s.setData(s.data),s.upCurrentId(),this.inputTask.node.value=""}},d=class extends t{constructor(t,s){super(t,"main","main-wrapper"),this.sectionAdd=new a(this.node,s,"Add Item"),this.sectionIncomplete=new n(this.node,s,!1,"Todo"),this.sectionCompleted=new n(this.node,s,!0,"Completed"),s.onChange.add((t=>{this.updateTaskLists(t)}))}updateTaskLists(t){this.sectionIncomplete.destroy(),this.sectionIncomplete=new n(this.node,t,!1,"Todo"),this.sectionCompleted.destroy(),this.sectionCompleted=new n(this.node,t,!0,"Completed")}};class o{constructor(t){this.data=t,this.currentId=this.getMaxId()+1,this.onChange=new class{listeners=[];constructor(){this.listeners=[]}add(t){this.listeners.push(t)}remove(t){this.listeners=this.listeners.filter((s=>s!==t))}emit(t){this.listeners.forEach((s=>s(t)))}}}getMaxId(){return Math.max(...Object.keys(this.data))}upCurrentId(){this.currentId+=1}getData(){return this.data}setData(t){this.data=t,this.onChange.emit(this),this.saveData()}saveData(){localStorage.setItem("savedTaskList",JSON.stringify(this.data))}}window.onload=()=>{const t=(()=>{const t={0:{isCompleted:!1,isEdit:!1,task:"Pay Bills"},1:{isCompleted:!1,isEdit:!0,task:"Go Shopping"},2:{isCompleted:!0,isEdit:!1,task:"See the Doctor"}};let s="";try{s=JSON.parse(localStorage.getItem("savedTaskList"))}catch{s=t}return null!==s&&"object"==typeof s||(s=t),s})(),s=new o(t);new d(document.body,s).aaa=""}})()})();